<span data-ttu-id="55d08-101">Anta att du planerar arkitekturen till ett distribuerat program för delning av musik.</span><span class="sxs-lookup"><span data-stu-id="55d08-101">Suppose you are planning the architecture of a distributed music-sharing application.</span></span> <span data-ttu-id="55d08-102">Du vill att programmet ska vara så tillförlitligt och skalbart som möjligt och du planerar att använda Azure-tekniker till att bygga en robust kommunikationsinfrastruktur.</span><span class="sxs-lookup"><span data-stu-id="55d08-102">You want to ensure that the application is as reliable and scalable as possible, and you intend to use Azure technologies to build a robust communication infrastructure.</span></span>

<span data-ttu-id="55d08-103">Innan du kan välja rätt Azure-teknik, måste du förstå varje enskild kommunikation som komponenterna i programmet utbyter.</span><span class="sxs-lookup"><span data-stu-id="55d08-103">Before you can choose the right Azure technology, you must understand each individual communication that the components of the application exchange.</span></span> <span data-ttu-id="55d08-104">Du kan välja olika Azure-tekniker för olika sorters kommunikation.</span><span class="sxs-lookup"><span data-stu-id="55d08-104">For each communication you can choose a different Azure technology.</span></span>

<span data-ttu-id="55d08-105">Det första du ska ta reda på är om en kommunikation skickar **meddelanden** eller **händelser**.</span><span class="sxs-lookup"><span data-stu-id="55d08-105">The first thing to understand about a communication is whether it sends **messages** or **events**.</span></span> <span data-ttu-id="55d08-106">Det här är ett grundläggande val som hjälper dig att välja rätt Azure-tjänst att använda.</span><span class="sxs-lookup"><span data-stu-id="55d08-106">This is a fundamental choice that will help you choose the appropriate Azure service to use.</span></span>

## <a name="what-is-a-message"></a><span data-ttu-id="55d08-107">Vad är ett meddelande?</span><span class="sxs-lookup"><span data-stu-id="55d08-107">What is a message?</span></span>
<span data-ttu-id="55d08-108">I terminologin för distribuerade program har **meddelanden** följande egenskaper:</span><span class="sxs-lookup"><span data-stu-id="55d08-108">In the terminology of distributed applications, **messages** have the following characteristics:</span></span>

- <span data-ttu-id="55d08-109">Meddelandet innehåller rådata som genereras av en komponent och som ska användas av en annan komponent.</span><span class="sxs-lookup"><span data-stu-id="55d08-109">A message contains raw data, produced by one component, that will be consumed by another component.</span></span>
- <span data-ttu-id="55d08-110">Ett meddelande innehåller själva informationen, inte bara en referens till dessa data.</span><span class="sxs-lookup"><span data-stu-id="55d08-110">A message contains the data itself, not just a reference to that data.</span></span>
- <span data-ttu-id="55d08-111">Den sändande komponenten förväntar sig att meddelandeinnehållet ska bearbetas på ett visst sätt av målkomponenten.</span><span class="sxs-lookup"><span data-stu-id="55d08-111">The sending component expects the message content to be processed in a certain way by the destination component.</span></span> <span data-ttu-id="55d08-112">Det övergripande systemets integritet kan vara beroende av att både avsändaren och mottagaren utför ett specifikt jobb.</span><span class="sxs-lookup"><span data-stu-id="55d08-112">The integrity of the overall system may depend on both sender and receiver doing a specific job.</span></span>

<span data-ttu-id="55d08-113">Anta exempelvis att en användare laddar upp en ny låt med hjälp av mobilappen för musikdelning.</span><span class="sxs-lookup"><span data-stu-id="55d08-113">For example, suppose a user uploads a new song by using the mobile music-sharing app.</span></span> <span data-ttu-id="55d08-114">Mobilappen måste skicka låten till den webb-API som körs i Azure.</span><span class="sxs-lookup"><span data-stu-id="55d08-114">The mobile app must send that song to the web API that runs in Azure.</span></span> <span data-ttu-id="55d08-115">Själva mediefilen måste skickas, inte bara en avisering som anger att en ny låt har lagts till.</span><span class="sxs-lookup"><span data-stu-id="55d08-115">The song media file itself must be sent, not just an alert that indicates that a new song has been added.</span></span> <span data-ttu-id="55d08-116">Mobilappen förväntar sig att webb-API:n sparar den nya låten i databasen och gör den tillgänglig för andra användare.</span><span class="sxs-lookup"><span data-stu-id="55d08-116">The mobile app expects that the web API will store the new song in the database and make it available to other users.</span></span> <span data-ttu-id="55d08-117">Detta är ett exempel på ett meddelande.</span><span class="sxs-lookup"><span data-stu-id="55d08-117">This is an example of a message.</span></span>

## <a name="what-is-an-event"></a><span data-ttu-id="55d08-118">Vad är en händelse?</span><span class="sxs-lookup"><span data-stu-id="55d08-118">What is an event?</span></span>

<span data-ttu-id="55d08-119">**Händelser** är enklare än meddelanden och används oftast för sändningskommunikation.</span><span class="sxs-lookup"><span data-stu-id="55d08-119">**Events** are lighter weight than messages, and are most often used for broadcast communications.</span></span> <span data-ttu-id="55d08-120">De komponenter som skickar händelsen kallas för **utgivare** och mottagare kallas för **prenumeranter**.</span><span class="sxs-lookup"><span data-stu-id="55d08-120">The components sending the event are known as **publishers**, and receivers are known as **subscribers**.</span></span>

<span data-ttu-id="55d08-121">Med händelser avgör mottagande komponenter i allmänhet vilken kommunikation man är intresserad av och därefter ”prenumererar” man på den.</span><span class="sxs-lookup"><span data-stu-id="55d08-121">With events, receiving components will generally decide in which communications they are interested, and will "subscribe" to those.</span></span> <span data-ttu-id="55d08-122">Prenumerationen hanteras vanligtvis av en mellanhand, till exempel Azure Event Grid eller Azure Event Hubs.</span><span class="sxs-lookup"><span data-stu-id="55d08-122">The subscription is usually managed by an intermediary, like Azure Event Grid or Azure Event Hubs.</span></span> <span data-ttu-id="55d08-123">När utgivaren skickar en händelse kommer mellanhanden att dirigera händelsen till intresserade prenumeranter.</span><span class="sxs-lookup"><span data-stu-id="55d08-123">When publishers send an event, the intermediary will route that event to interested subscribers.</span></span> <span data-ttu-id="55d08-124">Det kallas en ”publicera/prenumerera-arkitektur”.</span><span class="sxs-lookup"><span data-stu-id="55d08-124">This is known as a "publish-subscribe architecture."</span></span> <span data-ttu-id="55d08-125">Det är inte det enda sättet att hantera händelser, men det är det vanligaste.</span><span class="sxs-lookup"><span data-stu-id="55d08-125">It is not the only way to deal with events, but it is the most common.</span></span>

<span data-ttu-id="55d08-126">Händelser har följande egenskaper:</span><span class="sxs-lookup"><span data-stu-id="55d08-126">Events have the following characteristics:</span></span>

- <span data-ttu-id="55d08-127">En händelse är ett förenklat meddelande som anger att något har inträffat.</span><span class="sxs-lookup"><span data-stu-id="55d08-127">An event is a lightweight notification that indicates that something happened.</span></span>
- <span data-ttu-id="55d08-128">Händelsen kan skickas till flera mottagare eller inte till någon alls.</span><span class="sxs-lookup"><span data-stu-id="55d08-128">The event may be sent to multiple receivers, or to none at all.</span></span>
- <span data-ttu-id="55d08-129">Händelser är ofta avsedda att ”förgrenas” eller har ett stort antal prenumeranter för varje utgivare.</span><span class="sxs-lookup"><span data-stu-id="55d08-129">Events are often intended to "fan out," or have a large number of subscribers for each publisher.</span></span>
- <span data-ttu-id="55d08-130">Utgivaren av händelsen har ingen förväntan på åtgärder från den mottagande komponenten.</span><span class="sxs-lookup"><span data-stu-id="55d08-130">The publisher of the event has no expectation about the action a receiving component takes.</span></span>
- <span data-ttu-id="55d08-131">Vissa händelser är diskreta enheter som inte är relaterade till andra händelser.</span><span class="sxs-lookup"><span data-stu-id="55d08-131">Some events are discrete units and unrelated to other events.</span></span> 
- <span data-ttu-id="55d08-132">Vissa händelser är en del av en relaterad och ordnad serie.</span><span class="sxs-lookup"><span data-stu-id="55d08-132">Some events are part of a related and ordered series.</span></span>  

<span data-ttu-id="55d08-133">Anta exempelvis att filuppladdningen av musik har slutförts och att en ny låt har lagts till i databasen.</span><span class="sxs-lookup"><span data-stu-id="55d08-133">For example, suppose the music file upload has been completed, and the new song has been added to the database.</span></span> <span data-ttu-id="55d08-134">För att kunna informera användarna om den nya filen måste webb-API:n meddela webbklientdelen och mobilappanvändarna om detta.</span><span class="sxs-lookup"><span data-stu-id="55d08-134">In order to inform users of the new file, the web API must inform the web front end and mobile app users of the new file.</span></span> <span data-ttu-id="55d08-135">Användarna kan välja om de vill lyssna på den nya låten. Därför innehåller den första aviseringen inte musikfilen, utan meddelar bara användarna om att låten finns.</span><span class="sxs-lookup"><span data-stu-id="55d08-135">The users can choose whether to listen to the new song, so the initial notification does not include the music file but only notifies users that the song exists.</span></span> <span data-ttu-id="55d08-136">Avsändaren har inte någon specifik förväntan på att händelsemottagarna ska göra något särskilt som svar på mottagandet av händelsen.</span><span class="sxs-lookup"><span data-stu-id="55d08-136">The sender does not have a specific expectation that the event receivers will do anything particular in responsiveness of receiving this event.</span></span>

<span data-ttu-id="55d08-137">Detta är ett exempel på en diskret händelse.</span><span class="sxs-lookup"><span data-stu-id="55d08-137">This is an example of a discrete event.</span></span>

## <a name="how-to-choose-messages-or-events"></a><span data-ttu-id="55d08-138">Att välja meddelanden eller händelser</span><span class="sxs-lookup"><span data-stu-id="55d08-138">How to choose messages or events</span></span>

<span data-ttu-id="55d08-139">Ett program använder troligen händelser för vissa syften och meddelanden för andra.</span><span class="sxs-lookup"><span data-stu-id="55d08-139">A single application is likely to use events for some purposes and messages for others.</span></span> <span data-ttu-id="55d08-140">Innan du väljer måste du analysera din programarkitektur och dess användning för att identifiera de olika syften som dess komponenter har för att kommunicera med varandra.</span><span class="sxs-lookup"><span data-stu-id="55d08-140">Before you choose, you must analyze your application's architecture and all its use cases, to identify all the different purposes where its components have to communicate with each other.</span></span>

<span data-ttu-id="55d08-141">Händelser används troligen för sändningar och är ofta tillfälliga, vilket innebär att ett meddelande kanske inte hanteras av någon mottagare om ingen prenumererar för närvarande.</span><span class="sxs-lookup"><span data-stu-id="55d08-141">Events are more likely to be used for broadcasts and are often ephemeral, meaning a communication might not be handled by any receiver if none are currently subscribing.</span></span> <span data-ttu-id="55d08-142">Det är sannolikt att meddelanden används där det distribuerade programmet kräver en garanti för att kommunikationen kommer att bearbetas.</span><span class="sxs-lookup"><span data-stu-id="55d08-142">Messages are more likely to be used where the distributed application requires a guarantee that the communication will be processed.</span></span>

<span data-ttu-id="55d08-143">För varje typ av kommunikation bör du ställa dig följande fråga: **Förväntar den sändande komponenten att kommunikationen ska bearbetas på ett visst sätt av målkomponenten?**</span><span class="sxs-lookup"><span data-stu-id="55d08-143">For each communication, consider the following question: **Does the sending component expect the communication to be processed in a particular way by the destination component?**</span></span>

<span data-ttu-id="55d08-144">Om svaret är _Ja_ bör du välja att använda ett meddelande.</span><span class="sxs-lookup"><span data-stu-id="55d08-144">If the answer is _yes_, choose to use a message.</span></span> <span data-ttu-id="55d08-145">Om svaret är _Nej_ kan du kanske använda händelser.</span><span class="sxs-lookup"><span data-stu-id="55d08-145">If the answer is _no_, you may be able to use events.</span></span>

<span data-ttu-id="55d08-146">Att förstå hur komponenterna behöver kommunicera hjälper dig att välja hur komponenterna ska kommunicera.</span><span class="sxs-lookup"><span data-stu-id="55d08-146">Understanding how your components need to communicate will help you to choose how your components will communicate.</span></span> <span data-ttu-id="55d08-147">Vi börjar med meddelanden.</span><span class="sxs-lookup"><span data-stu-id="55d08-147">Let's start with messages.</span></span>