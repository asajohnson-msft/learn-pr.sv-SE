<span data-ttu-id="270db-101">Det är ovanligt att vi kan förutse den exakta belastningen i systemet: användningen av de offentliga programmen kan öka snabbt eller ett internt program kan behöva hantera ett större antal användare när verksamheten växer.</span><span class="sxs-lookup"><span data-stu-id="270db-101">It's rare that we can exactly predict the load on our system: public facing applications might grow rapidly or an internal application might need to support a larger user base as the business grows.</span></span> <span data-ttu-id="270db-102">Även om vi kan förutse belastningen är den sällan konstant: återförsäljarna har större efterfrågan under helger och sportwebbplatserna har högst belastning under slutspel.</span><span class="sxs-lookup"><span data-stu-id="270db-102">Even when we can predict load, it's rarely flat: retailers have more demand during the holidays and sports websites peak during playoffs.</span></span> <span data-ttu-id="270db-103">Här definierar vi begreppen _skala upp/ned_ och _skala ut/in_, berättar om hur Azure kan förbättra dina skalningsmöjligheter på olika sätt och tittar på hur serverfria tekniker och containertekniker kan förbättra arkitekturens möjligheter till skalning.</span><span class="sxs-lookup"><span data-stu-id="270db-103">Here, we'll define _scaling up/down_ and _scaling out/in_, cover some ways Azure can improve your scaling capabilities, and look at how serverless and container technologies can improve your architecture's ability to scale.</span></span>

## <a name="what-is-scaling"></a><span data-ttu-id="270db-104">Vad är skalning?</span><span class="sxs-lookup"><span data-stu-id="270db-104">What is scaling?</span></span>

<span data-ttu-id="270db-105">_Skalning_ är en process för att hantera dina resurser och se till att programmen uppfyller en uppsättning prestandakrav.</span><span class="sxs-lookup"><span data-stu-id="270db-105">_Scaling_ is the process of managing your resources to help your application meet a set of performance requirements.</span></span>  <span data-ttu-id="270db-106">När vi har för många resurser som nyttjas av användare används de inte effektivt och det kostar pengar.</span><span class="sxs-lookup"><span data-stu-id="270db-106">When we have too many resources serving users, we won't be using it efficiently and we'll be wasting money.</span></span> <span data-ttu-id="270db-107">För få tillgängliga resurser innebär att prestanda för programmet kan påverkas.</span><span class="sxs-lookup"><span data-stu-id="270db-107">Too few available resources means that the performance of our application could be impacted.</span></span> <span data-ttu-id="270db-108">Målet är att uppfylla våra definierade prestandakrav och samtidigt optimera kostnaderna.</span><span class="sxs-lookup"><span data-stu-id="270db-108">The goal is to meet our defined performance requirements while optimizing for cost.</span></span> 

<span data-ttu-id="270db-109">”_Resurser_” kan referera till allt som behövs för att köra programmen.</span><span class="sxs-lookup"><span data-stu-id="270db-109">"_Resources_" can refer to anything we need to manage to run our applications.</span></span> <span data-ttu-id="270db-110">Minne och processor för virtuella datorer är de mest uppenbara resurserna, men vissa Azure-tjänster kräver att du även beaktar bandbredd eller abstrakta element som enheter för programbegäran i Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="270db-110">Memory and CPU for virtual machines are the most obvious resources, but some Azure services might be require you to consider bandwidth or abstractions like Cosmos DB Request Units.</span></span>

<span data-ttu-id="270db-111">I en värld där programefterfrågan är konstant är det enkelt att förutse vilka resurser som krävs.</span><span class="sxs-lookup"><span data-stu-id="270db-111">In a world where application demand is constant, it's easy to predict the needed level of resource.</span></span> <span data-ttu-id="270db-112">I verkligheten växlar kraven på programmen över tid och efterfrågan blir då svårare att förutse.</span><span class="sxs-lookup"><span data-stu-id="270db-112">In the real world, the demands of our applications change over time, so it can be harder to predict.</span></span> <span data-ttu-id="270db-113">Om du har tur kan förändringarna vara förutsebara eller säsongsberoende, men det är inte det vanligaste för många program.</span><span class="sxs-lookup"><span data-stu-id="270db-113">If you're lucky, then that change will be predictable or seasonal, but that is not typical of all applications.</span></span> <span data-ttu-id="270db-114">Det mest optimala är att etablera rätt mängd resurser för att möta efterfrågan och göra justeringar då efterfrågan ändras.</span><span class="sxs-lookup"><span data-stu-id="270db-114">Ideally, you want to provision the right amount of resources to meet demand and adjust as demand changes.</span></span>

<span data-ttu-id="270db-115">Skalning är svårt i ett lokalt scenario då du köper och hanterar dina egna servrar.</span><span class="sxs-lookup"><span data-stu-id="270db-115">Scaling is difficult in an on-premises scenario, where you purchase and manage your own servers.</span></span> <span data-ttu-id="270db-116">Det kan bli dyrt att lägga till resurser och det tar ofta för lång tid att etablera dem online, ibland längre tid än det faktiska behovet av ökad kapacitet.</span><span class="sxs-lookup"><span data-stu-id="270db-116">Adding resources can be costly and often takes too much time to bring online, sometimes longer than your actual need for the increased capacity.</span></span> <span data-ttu-id="270db-117">Det kan vara lika svårt att sedan minska kapaciteten under perioder med låg belastning på systemet, och då står du där med en ökad kostnad.</span><span class="sxs-lookup"><span data-stu-id="270db-117">It can be just as difficult to then reduce capacity during times of low-demand on the system, so you may be stuck with the increased cost.</span></span>

<span data-ttu-id="270db-118">Enkel skalning är en viktig fördel med Azure.</span><span class="sxs-lookup"><span data-stu-id="270db-118">Easy scaling is a key benefit of Azure.</span></span> <span data-ttu-id="270db-119">Med de flesta Azure-resurser kan du enkelt lägga till eller ta bort resurser i takt med en ändrad efterfrågan, och många tjänster har automatiserade alternativ för övervakning av efterfrågan och justeras därefter automatiskt.</span><span class="sxs-lookup"><span data-stu-id="270db-119">Most Azure resources let you easily add or remove resources as demand changes, and many services have automated options so they monitor demand and adjust for you.</span></span> <span data-ttu-id="270db-120">Med funktionen för automatisk skalning, som ofta kallas autoskalning, kan du ange tröskelvärden för lägsta och högsta nivå av instanser som ska vara tillgängliga, och instanser läggs till eller tas bort baserat på prestandamått (till exempel CPU-användning).</span><span class="sxs-lookup"><span data-stu-id="270db-120">This automatic scaling capability, commonly known as autoscaling, lets you set thresholds for the minimum and maximum level of instances that should be available, and will add or remove instances based upon a performance metric (for example, CPU utilization).</span></span>

## <a name="what-is-scaling-up-and-down"></a><span data-ttu-id="270db-121">Vad innebär det att skala upp och ned?</span><span class="sxs-lookup"><span data-stu-id="270db-121">What is scaling up and down?</span></span>

<span data-ttu-id="270db-122">Skala upp är en process där vi ökar kapaciteten för en viss instans.</span><span class="sxs-lookup"><span data-stu-id="270db-122">Scaling up is the process where we increase the capacity of a given instance.</span></span> <span data-ttu-id="270db-123">En virtuell dator kan utökas från 1 virtuell processor och 3,5 GB RAM-minne till 2 virtuella processorer och 7 GB RAM-minne för att ge mer bearbetningskapacitet.</span><span class="sxs-lookup"><span data-stu-id="270db-123">A virtual machine could be increased from 1 vCPU and 3.5 GB of RAM to 2 vCPUs and 7 GB of RAM to provide more processing capacity.</span></span> <span data-ttu-id="270db-124">På motsvarande sätt innebär processen att skala ned att kapaciteten minskas för en viss instans.</span><span class="sxs-lookup"><span data-stu-id="270db-124">On the other hand, scaling down is the process where we lower the capacity of a given instance.</span></span> <span data-ttu-id="270db-125">Om du till exempel minskar kapaciteten för en virtuell dator från 2 virtuella processorer och 7 GB RAM-minne till 1 virtuell processor och 3,5 GB RAM-minne minskar både kapaciteten och kostnaden.</span><span class="sxs-lookup"><span data-stu-id="270db-125">For example, reducing a virtual machine's capacity from 2 vCPUs and 7 GB of RAM to 1 vCPU and 3.5 GB of RAM, reducing both capacity and cost.</span></span>

![scale-up-down](../media/ScaleUpDown.png)

<span data-ttu-id="270db-127">Låt oss ta en titt på vad skala upp/ned kan innebära för Azure-resurser:</span><span class="sxs-lookup"><span data-stu-id="270db-127">Let's take a look at what scaling up/down means in the context of Azure resources:</span></span>

* <span data-ttu-id="270db-128">På virtuella Azure-datorer skalar du baserat på en VM-storlek.</span><span class="sxs-lookup"><span data-stu-id="270db-128">In Azure virtual machines, you scale based upon a virtual machine size.</span></span> <span data-ttu-id="270db-129">Den storleken associeras med en viss mängd virtuella processorer, RAM-minne och lokal lagring.</span><span class="sxs-lookup"><span data-stu-id="270db-129">That size has a certain amount of vCPUs, RAM, and local storage associated with it.</span></span> <span data-ttu-id="270db-130">Vi kan exempelvis skala upp från en virtuell dator på Standard_DS1_v2 (1 virtuell processor och 3,5 GB RAM-minne) till en virtuell dator på Standard_DS2_v2 (2 virtuella processorer och 7 GB RAM-minne).</span><span class="sxs-lookup"><span data-stu-id="270db-130">For example, we could scale up from a Standard_DS1_v2 virtual machine (1 vCPU and 3.5 GB of RAM) to a Standard_DS2_v2 virtual machine (2 vCPUs and 7 GB of RAM).</span></span>
* <span data-ttu-id="270db-131">Azure SQL Database är en plattform som en tjänst-implementering (PaaS) av Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="270db-131">Azure SQL Database is a platform as a service (PaaS) implementation of Microsoft SQL Server.</span></span>  <span data-ttu-id="270db-132">Du kan skala upp en databas baserat på antalet databastransaktionsenheter (DTU) eller virtuella processorer.</span><span class="sxs-lookup"><span data-stu-id="270db-132">You can scale up a database based upon the number of database transaction units (DTUs) or vCPUs.</span></span> <span data-ttu-id="270db-133">DTU:er är en abstraktion av underliggande resurser och är en blandning av CPU, IO och minne.</span><span class="sxs-lookup"><span data-stu-id="270db-133">DTUs are an abstraction of underlying resources and are a blend of CPU, IO, and memory.</span></span> <span data-ttu-id="270db-134">Du kan skala din databasinstans från 500 DTU:er till 250 DTU:er.</span><span class="sxs-lookup"><span data-stu-id="270db-134">You could scale your database instance from 500 DTUs to 250 DTUs.</span></span>
* <span data-ttu-id="270db-135">Azure App Service är en värdtjänst för PaaS-webbplatsen i Azure.</span><span class="sxs-lookup"><span data-stu-id="270db-135">Azure App Service is a PaaS website hosting service on Azure.</span></span> <span data-ttu-id="270db-136">Webbplatserna körs på en virtuell servergrupp, som även kallas App Service-plan.</span><span class="sxs-lookup"><span data-stu-id="270db-136">Web sites run on a virtual server farm, also known as an App Service Plan.</span></span> <span data-ttu-id="270db-137">Du kan skala upp eller ned App Service-planen mellan nivåerna och har kapacitetsalternativ inom nivåerna.</span><span class="sxs-lookup"><span data-stu-id="270db-137">You can scale the App Service Plan up or down between tiers and have capacity options within tiers.</span></span> <span data-ttu-id="270db-138">En S1-App Service-plan har till exempel 1 virtuell processor och 1,75 GB RAM-minne per instans.</span><span class="sxs-lookup"><span data-stu-id="270db-138">For example, an S1 app service plan has 1 vCPU and 1.75 GB of RAM per instance.</span></span> <span data-ttu-id="270db-139">Vi kan skala upp till en S2-App Service-plan som har 2 virtuella processorer och 3 GB RAM-minne per instans.</span><span class="sxs-lookup"><span data-stu-id="270db-139">We could scale up to an S2 app service plan, which has 2 vCPUs and 3 GB of RAM per instance.</span></span>

<span data-ttu-id="270db-140">För att få dessa funktioner i en lokal miljö skulle du vanligtvis behöva vänta på inköp av den nödvändiga maskinvaran och installationen innan du kan börja använda den nya skalningsnivån.</span><span class="sxs-lookup"><span data-stu-id="270db-140">To have these capabilities in an on-premises environment you would typically have to wait for procurement of the needed hardware and installation before you can start using the new level of scale.</span></span> <span data-ttu-id="270db-141">I Azure har de fysiska resurserna redan distribuerats och är tillgängliga för dig. Du behöver bara välja den alternativa skalningsnivån som du vill använda.</span><span class="sxs-lookup"><span data-stu-id="270db-141">In Azure, the physical resources are already deployed and available for you, you simply need to select the alternate level of scale that you are looking to use.</span></span>

<span data-ttu-id="270db-142">Du kan behöva ta hänsyn till effekterna av att skala upp i din lösning, beroende på vilka molntjänster som du har valt.</span><span class="sxs-lookup"><span data-stu-id="270db-142">You may need to consider the impact of scaling up in your solution, depending upon the cloud services that you have chosen.</span></span>

<span data-ttu-id="270db-143">Om du till exempel väljer att skala upp i Azure SQL Database hanterar tjänsten uppskalning av enskilda noder och fortsätter driften av tjänsten.</span><span class="sxs-lookup"><span data-stu-id="270db-143">For example, if you choose to scale up in Azure SQL Database, then the service deals with scaling up individual nodes and continues the operation of your service.</span></span> <span data-ttu-id="270db-144">När du ändrar servicenivån och/eller prestandanivån för en databas skapas en replik av den ursprungliga databasen på den nya prestandanivån och sedan växlas anslutningar över till repliken.</span><span class="sxs-lookup"><span data-stu-id="270db-144">Changing the service tier and/or performance level of a database creates a replica of the original database at the new performance level, and then switches connections over to the replica.</span></span> <span data-ttu-id="270db-145">Inga data förloras under den här processen och det blir bara ett kort avbrott (vanligtvis mindre än fyra sekunder) när tjänsten växlar över till repliken.</span><span class="sxs-lookup"><span data-stu-id="270db-145">No data is lost during this process and there's only a brief interruption (typically less than four seconds) when the service switches over to the replica.</span></span>

<span data-ttu-id="270db-146">Om du vill skala upp eller ned en virtuell dator kan du även göra det genom att välja en annan instansstorlek.</span><span class="sxs-lookup"><span data-stu-id="270db-146">Alternatively, if you choose to scale up or down a virtual machine, you do so by selecting a different instance size.</span></span> <span data-ttu-id="270db-147">I de flesta fall kräver detta en omstart av den virtuella datorn, så det är bäst att förvänta sig att en omstart krävs och att du måste ha det i åtanke när du utför den här åtgärden.</span><span class="sxs-lookup"><span data-stu-id="270db-147">In most cases this requires a restart of the VM, so best to have the expectation that a reboot will be required and you'll need to account for when performing this activity.</span></span>

<span data-ttu-id="270db-148">Slutligen bör du alltid överväga att skala ned när detta är ett alternativ.</span><span class="sxs-lookup"><span data-stu-id="270db-148">Finally, you should always look for places where scaling down is an option.</span></span> <span data-ttu-id="270db-149">Om ditt program ger tillfredsställande prestanda på en lägre prisnivå, kan Azure-fakturan minskas avsevärt.</span><span class="sxs-lookup"><span data-stu-id="270db-149">If your application can provide adequate performance at a lower price tier, your Azure bill could be significantly reduced.</span></span>

## <a name="what-is-scaling-out-and-in"></a><span data-ttu-id="270db-150">Vad innebär det att skala ut och in?</span><span class="sxs-lookup"><span data-stu-id="270db-150">What is scaling out and in?</span></span>

<span data-ttu-id="270db-151">Medan en skalning upp och ned justerar mängden resurser en instans har tillgängliga, innebär skalning ut och in att det totala antalet instanser justeras.</span><span class="sxs-lookup"><span data-stu-id="270db-151">Where scaling up and down adjusts the amount of resources a single instance has available, scaling out and in adjusts the total number of instances.</span></span>

<span data-ttu-id="270db-152">_Skala ut_ är en process där fler instanser läggs till för att ge stöd för belastningen i din lösning.</span><span class="sxs-lookup"><span data-stu-id="270db-152">_Scaling out_ is the process of adding more instances to support the load of your solution.</span></span> <span data-ttu-id="270db-153">Om klientdelen av webbplatsen till exempel finns på virtuella datorer så kan vi öka antalet virtuella datorer om belastningen ökar.</span><span class="sxs-lookup"><span data-stu-id="270db-153">For example, if our website frontend was hosted on virtual machines, then we could increase the number of virtual machines if the level of load increased.</span></span>

<span data-ttu-id="270db-154">_Skala in_ är en process som innebär att ta bort instanser som inte längre behövs för att ge stöd för belastningen i din lösning.</span><span class="sxs-lookup"><span data-stu-id="270db-154">_Scaling in_ is the process of removing instances that are no longer needed to support the load of your solution.</span></span> <span data-ttu-id="270db-155">Om webbplatsens klientdelar har låg belastning kan vi minska antalet instanser för att minska kostnaderna.</span><span class="sxs-lookup"><span data-stu-id="270db-155">If the website front ends have low usage, then we may want to lower the number of instances to save cost.</span></span>


![scale-in-out](../media/ScaleInOut.png)

<span data-ttu-id="270db-157">Här följer några exempel på vad skala ut/in innebär i samband med Azure-resurser:</span><span class="sxs-lookup"><span data-stu-id="270db-157">Here are some examples of what scaling out/in means in the context of Azure resources:</span></span>

* <span data-ttu-id="270db-158">För infrastrukturlagret skulle du förmodligen använda VM-skalningsuppsättningar för att automatisera tillägg och borttagningar av extra instanser.</span><span class="sxs-lookup"><span data-stu-id="270db-158">For the infrastructure layer, you would likely use virtual machine scale sets to automate the addition and removal of extra instances.</span></span>
  * <span data-ttu-id="270db-159">Med VM-skalningsuppsättningar kan du skapa och hantera grupper med identiska och belastningsutjämnade virtuella datorer.</span><span class="sxs-lookup"><span data-stu-id="270db-159">Virtual machine scale sets let you create and manage a group of identical, load balanced VMs.</span></span>
  * <span data-ttu-id="270db-160">Antal VM-instanser kan automatiskt öka eller minska som svar på efterfrågan eller ett definierat schema.</span><span class="sxs-lookup"><span data-stu-id="270db-160">The number of VM instances can automatically increase or decrease in response to demand or a defined schedule.</span></span>
* <span data-ttu-id="270db-161">I en Azure SQL Database-implementering kan du fördela belastningen över databasinstanser med hjälp av horisontell partitionering.</span><span class="sxs-lookup"><span data-stu-id="270db-161">In an Azure SQL Database implementation, you could share the load across database instances by sharding.</span></span> <span data-ttu-id="270db-162">_Horisontell partitionering_ är en teknik som används för att distribuera stora mängder identiskt strukturerade data över ett antal oberoende databaser.</span><span class="sxs-lookup"><span data-stu-id="270db-162">_Sharding_ is a technique to distribute large amounts of identically structured data across a number of independent databases.</span></span>
* <span data-ttu-id="270db-163">I Azure App Service är App Service-planen den virtuella webbservergruppen som är värd för ditt innehåll.</span><span class="sxs-lookup"><span data-stu-id="270db-163">In Azure App Service, the App Service Plan is the virtual web server farm hosting your content.</span></span> <span data-ttu-id="270db-164">Skala ut innebär på detta sätt att du ökar antalet virtuella datorer i servergruppen.</span><span class="sxs-lookup"><span data-stu-id="270db-164">Scaling out in this way means that you're increasing the number of virtual machines in the farm.</span></span> <span data-ttu-id="270db-165">Precis som med VM-skalningsuppsättningar kan antalet instanser automatiskt ökas eller minskas som svar på vissa mått eller enligt ett schema.</span><span class="sxs-lookup"><span data-stu-id="270db-165">As with virtual machine scale sets, the number of instances can be automatically raised or lowered in response to certain metrics or a schedule.</span></span>

<span data-ttu-id="270db-166">Utskalning utförs vanligtvis enkelt på Azure-portalen, med kommandoradsverktyg eller med Resource Manager-mallar, och är i de flesta fall inte märkbar för slutanvändaren.</span><span class="sxs-lookup"><span data-stu-id="270db-166">Scaling out is typically easily performed in the Azure portal, command-line tools or Resource Manager templates, and in most cases is seamless to the end user.</span></span>

### <a name="autoscale"></a><span data-ttu-id="270db-167">Automatisk skalning</span><span class="sxs-lookup"><span data-stu-id="270db-167">Autoscale</span></span>

<span data-ttu-id="270db-168">Du kan konfigurera vissa av dessa tjänster för användning av en funktion som kallas autoskalning.</span><span class="sxs-lookup"><span data-stu-id="270db-168">You can configure some of these services to use a feature called autoscale.</span></span> <span data-ttu-id="270db-169">Med autoskalning behöver du inte längre tänka på att skala tjänsterna manuellt.</span><span class="sxs-lookup"><span data-stu-id="270db-169">With autoscale you no longer have to worry about scaling services manually.</span></span> <span data-ttu-id="270db-170">I stället kan du ange ett lägsta och ett högsta tröskelvärde för instanser och skala baserat på specifika mått (kölängd, CPU-användning) eller scheman (vardagar mellan 17:00 och 19:00).</span><span class="sxs-lookup"><span data-stu-id="270db-170">Instead, you can set a minimum and maximum threshold of instances and scale based upon specific metrics (queue length, CPU utilization) or schedules (weekdays between 5:00 PM and 7:00 PM).</span></span>

![autoskalning](../media/autoscale.png)

### <a name="considerations-when-scaling-in-and-out"></a><span data-ttu-id="270db-172">Att tänka på när du skalar in och ut</span><span class="sxs-lookup"><span data-stu-id="270db-172">Considerations when scaling in and out</span></span>

<span data-ttu-id="270db-173">Vid utskalning kan starttiden för ditt program påverka hur snabbt ditt program kan skalas.</span><span class="sxs-lookup"><span data-stu-id="270db-173">When scaling out, the startup time of your application can impact how quickly your application can scale.</span></span> <span data-ttu-id="270db-174">Om webbappen tar två minuter att starta och bli tillgänglig för användarna innebär det att det tar två minuter för var och en av dina instanser innan de blir tillgängliga för användarna.</span><span class="sxs-lookup"><span data-stu-id="270db-174">If your web app takes two minutes to start up and be available for users, that means each of your instances will take two minutes until they are available to your users.</span></span> <span data-ttu-id="270db-175">Du bör beakta den här starttiden när du bestämmer hur snabbt du vill skala.</span><span class="sxs-lookup"><span data-stu-id="270db-175">You'll want to take this startup time into consideration when determining how fast you want to scale.</span></span>

<span data-ttu-id="270db-176">Du måste också tänka på hur programmet hanterar tillstånd.</span><span class="sxs-lookup"><span data-stu-id="270db-176">You'll also need to think about how your application handles state.</span></span> <span data-ttu-id="270db-177">När programmet skalas in är tillstånd som lagrats på datorn inte längre tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="270db-177">When the application scales in, any state stored on the machine is no longer available.</span></span> <span data-ttu-id="270db-178">Om en användare ansluter till en instans som inte har tillgång till tillståndet, kan de bli tvingade att logga in, eller välja data på nytt, vilket ger en sämre användarupplevelse.</span><span class="sxs-lookup"><span data-stu-id="270db-178">If a user connects to an instance that doesn't have its state, it could force them to sign in, or re-select data, leading to a poor user experience.</span></span> <span data-ttu-id="270db-179">En vanlig metod är att lagra tillstånd externt i en annan tjänst som exempelvis Redis Cache eller SQL Database, vilket gör webbservrarna tillståndslösa.</span><span class="sxs-lookup"><span data-stu-id="270db-179">A common pattern is to externalize state to another service like Redis Cache or SQL Database, making your web servers stateless.</span></span> <span data-ttu-id="270db-180">Nu när klientdelarna av webben är tillståndslösa behöver vi inte bekymra oss om vilka enskilda instanser som är tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="270db-180">Now that our web front ends are stateless we don't need to worry about which individual instances are available.</span></span> <span data-ttu-id="270db-181">De gör alla samma jobb och distribueras på samma sätt.</span><span class="sxs-lookup"><span data-stu-id="270db-181">They are all doing the same job and are deployed in the same way.</span></span>

## <a name="throttling"></a><span data-ttu-id="270db-182">Begränsning</span><span class="sxs-lookup"><span data-stu-id="270db-182">Throttling</span></span>

<span data-ttu-id="270db-183">Vi har konstaterat att belastningen på ett program varierar över tid.</span><span class="sxs-lookup"><span data-stu-id="270db-183">We've established that the load on an application will vary over time.</span></span> <span data-ttu-id="270db-184">Detta kan bero på antalet aktiva eller samtidiga användare och de aktiviteter som utförs.</span><span class="sxs-lookup"><span data-stu-id="270db-184">This may be due to the number of active or concurrent users and the activities being performed.</span></span> <span data-ttu-id="270db-185">Vi kan använda autoskalning för att lägga till kapacitet och vi kan också använda en mekanism för bandbreddsbegränsning som begränsar antalet begäranden från en källa.</span><span class="sxs-lookup"><span data-stu-id="270db-185">While we could use autoscaling to add capacity, we could also use a throttling mechanism to limit the number of requests from a source.</span></span> <span data-ttu-id="270db-186">Vi kan skydda prestandabegränsningarna genom att ange kända begränsningar på programnivå, vilket hindrar programmet från att avbrytas.</span><span class="sxs-lookup"><span data-stu-id="270db-186">We can safeguard performance limits by putting known limits into place at the application level, preventing the application from breaking.</span></span> <span data-ttu-id="270db-187">Bandbreddsbegränsning används oftast i program som exponerar API-slutpunkter.</span><span class="sxs-lookup"><span data-stu-id="270db-187">Throttling is most frequently used in applications exposing API endpoints.</span></span>

<span data-ttu-id="270db-188">När programmet har identifierat att det inte överträder en gräns kan begränsning påbörjas och säkerställa att det övergripande systemserviceavtalet inte överträds.</span><span class="sxs-lookup"><span data-stu-id="270db-188">Once the application has identified that it would breach a limit, throttling could begin and ensure the overall system SLA isn't breached.</span></span> <span data-ttu-id="270db-189">Om vi till exempel har exponerat en API för kunderna för att hämta data kan vi begränsa antalet begäranden till 100 per minut.</span><span class="sxs-lookup"><span data-stu-id="270db-189">For example, if we exposed an API for customers to get data, we could limit the number of requests to 100 per minute.</span></span> <span data-ttu-id="270db-190">Om en enda kund överskrider denna gräns kan vi svara med statuskoden HTTP 429, inklusive väntetiden innan en annan begäran kan skickas.</span><span class="sxs-lookup"><span data-stu-id="270db-190">If any single customer exceeded this limit, we could respond with an HTTP 429 status code, including the wait time before another request can successfully be submitted.</span></span>

## <a name="serverless"></a><span data-ttu-id="270db-191">Utan server</span><span class="sxs-lookup"><span data-stu-id="270db-191">Serverless</span></span>

<span data-ttu-id="270db-192">Serverfri databehandling ger en molnbaserad körningsmiljö som kör dina appar men där den underliggande miljön är helt abstrakt.</span><span class="sxs-lookup"><span data-stu-id="270db-192">Serverless computing provides a cloud-hosted execution environment that runs your apps but completely abstracts the underlying environment.</span></span> <span data-ttu-id="270db-193">Du skapar en instans av tjänsten och lägger till din kod, men du behöver inte, och kan inte, hantera eller underhålla någon infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="270db-193">You create an instance of the service, and you add your code; no infrastructure management or maintenance is required, or even allowed.</span></span>

<span data-ttu-id="270db-194">Du konfigurerar dina serverfria appar för att svara på händelser.</span><span class="sxs-lookup"><span data-stu-id="270db-194">You configure your serverless apps to respond to events.</span></span> <span data-ttu-id="270db-195">Det kan gälla en REST-slutpunkt, en timer eller ett meddelande som tas emot från en annan Azure-tjänst.</span><span class="sxs-lookup"><span data-stu-id="270db-195">This could be a REST end point, a timer, or a message received from another Azure service.</span></span> <span data-ttu-id="270db-196">Den serverfria appen körs bara när den utlöses av en händelse.</span><span class="sxs-lookup"><span data-stu-id="270db-196">The serverless app runs only when it's triggered by an event.</span></span>

<span data-ttu-id="270db-197">Du ansvarar inte för infrastrukturen.</span><span class="sxs-lookup"><span data-stu-id="270db-197">Infrastructure isn't your responsibly.</span></span> <span data-ttu-id="270db-198">Skalning och prestanda hanteras automatiskt och du debiteras endast för de resurser du använder.</span><span class="sxs-lookup"><span data-stu-id="270db-198">Scaling and performance are handled automatically, and you are billed only for the exact resources you use.</span></span> <span data-ttu-id="270db-199">Du behöver inte ens reservera kapacitet.</span><span class="sxs-lookup"><span data-stu-id="270db-199">There's no need to even reserve capacity.</span></span> <span data-ttu-id="270db-200">Azure Functions, Azure Container Instances och Logic Apps är exempel på serverlös databehandling som är tillgänglig på Azure.</span><span class="sxs-lookup"><span data-stu-id="270db-200">Azure Functions, Azure Container Instances, and Logic Apps are examples of serverless computing available on Azure.</span></span>

<span data-ttu-id="270db-201">Nu ska vi gå tillbaka till exemplet med Lamna Healthcare.</span><span class="sxs-lookup"><span data-stu-id="270db-201">Let's revisit the Lamna Healthcare example.</span></span> <span data-ttu-id="270db-202">Det kan finnas en viss potential för att spara kostnader och förenkla hanteringen.</span><span class="sxs-lookup"><span data-stu-id="270db-202">There could be some potential for cost saving and ease of management.</span></span> <span data-ttu-id="270db-203">Överväg en API-slutpunkt.</span><span class="sxs-lookup"><span data-stu-id="270db-203">Consider an API endpoint.</span></span> <span data-ttu-id="270db-204">I stället för att ha Azure App Service som värd för API:et, där de måste betala för reserverad kapacitet, kan de använda en Azure Function-app som utlöses av en HTTP-begäran.</span><span class="sxs-lookup"><span data-stu-id="270db-204">Instead of hosting the API in Azure App Service where they must pay for reserved capacity, they could use an Azure Function App triggered by an HTTP request.</span></span> <span data-ttu-id="270db-205">Azure Functions skulle möjliggöra för teamet att endast betala för de resurser som krävs för att bearbeta varje transaktion.</span><span class="sxs-lookup"><span data-stu-id="270db-205">Azure functions would enable the team to only pay for the resources required to process each transactions.</span></span> <span data-ttu-id="270db-206">Kostnaden och skalningen skulle vara i direkt linje med antalet transaktioner i systemet.</span><span class="sxs-lookup"><span data-stu-id="270db-206">The cost and scale would be directly in line with the number of transactions in the system.</span></span>

## <a name="containers"></a><span data-ttu-id="270db-207">Containrar</span><span class="sxs-lookup"><span data-stu-id="270db-207">Containers</span></span>

<span data-ttu-id="270db-208">En container är en metod som kör program i en virtualiserad miljö.</span><span class="sxs-lookup"><span data-stu-id="270db-208">A container is a method running applications in a virtualized environment.</span></span> <span data-ttu-id="270db-209">En virtuell dator är virtualiserad på maskinvarunivå, där ett hypervisor-program gör det möjligt att köra flera virtualiserade operativsystem på en enda fysisk server.</span><span class="sxs-lookup"><span data-stu-id="270db-209">A virtual machine is virtualized at the hardware level, where a hypervisor makes it possible to run multiple virtualized operating systems on a single physical server.</span></span> <span data-ttu-id="270db-210">Containrar tar virtualiseringen till nästa nivå då virtualiseringen utförs på operativsystemsnivå, vilket gör det möjligt att köra flera identiska programinstanser inom samma OS.</span><span class="sxs-lookup"><span data-stu-id="270db-210">Containers take the virtualization up a level, the virtualization is done at the OS level, making it possible to run multiple identical application instances within the same OS.</span></span>

<span data-ttu-id="270db-211">Containrar passar mycket bra för utskalningsscenarier.</span><span class="sxs-lookup"><span data-stu-id="270db-211">Containers are well suited to scale out scenarios.</span></span> <span data-ttu-id="270db-212">De är menade att vara enkla och utformade för att kunna skapas, skalas ut och stoppas dynamiskt när miljön och behoven ändras.</span><span class="sxs-lookup"><span data-stu-id="270db-212">They are meant to be lightweight and are designed to be created, scaled out, and stopped dynamically as environment and demand change.</span></span>

<span data-ttu-id="270db-213">En fördel med att använda containrar är att du kan köra flera isolerade program på en virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="270db-213">A benefit of using containers is the ability to run multiple isolated applications on each virtual machine.</span></span> <span data-ttu-id="270db-214">Eftersom containrar är skyddade och isolerade i sig själva på kernelnivå behöver du inte nödvändigtvis separata virtuella datorer för olika arbetsbelastningar.</span><span class="sxs-lookup"><span data-stu-id="270db-214">Since containers themselves are secured and isolated at a kernel level, you don't necessarily need separate VMs for separate workloads.</span></span>

<span data-ttu-id="270db-215">Du kan köra containrar på virtuella datorer. Det finns ett par Azure-tjänster som fokuserar på att underlätta hantering och skalning av containrar:</span><span class="sxs-lookup"><span data-stu-id="270db-215">While you can run containers on virtual machines, there are a couple of Azure services that focus on easing the management and scaling of containers:</span></span>

* <span data-ttu-id="270db-216">**Azure Kubernetes Service (AKS)**</span><span class="sxs-lookup"><span data-stu-id="270db-216">**Azure Kubernetes Service (AKS)**</span></span>

  <span data-ttu-id="270db-217">Med Azure Kubernetes Service kan du konfigurera virtuella datorer så att de fungerar som noder.</span><span class="sxs-lookup"><span data-stu-id="270db-217">Azure Kubernetes Service allows you to set up virtual machines to act as your nodes.</span></span> <span data-ttu-id="270db-218">Azure är värd för Kubernetes hanteringsplan och fakturerar enbart för de arbetsnoder som körs som värdar för dina containrar.</span><span class="sxs-lookup"><span data-stu-id="270db-218">Azure hosts the Kubernetes management plane and only bills for the running worker nodes that host your containers.</span></span>

  <span data-ttu-id="270db-219">För att öka antalet arbetsnoder i Azure kan du använda Azure CLI och öka antalet manuellt.</span><span class="sxs-lookup"><span data-stu-id="270db-219">To increase the number of your worker nodes in Azure, you could use the Azure CLI to increase that manually.</span></span> <span data-ttu-id="270db-220">När detta skrivs finns det en förhandsversion av Cluster Autoscaler på AKS tillgänglig som möjliggör autoskalning av arbetsnoder.</span><span class="sxs-lookup"><span data-stu-id="270db-220">At time of writing, there is a preview of Cluster Autoscaler on AKS available that enables autoscaling of your worker nodes.</span></span> <span data-ttu-id="270db-221">I Kubernetes-klustret kan du använda Horizontal Pod Autoscaler för att skala ut antalet instanser av containern som ska distribueras.</span><span class="sxs-lookup"><span data-stu-id="270db-221">On your Kubernetes cluster, you could use the Horizontal Pod Autoscaler to scale out the number of instances of the container to be deployed.</span></span>

  <span data-ttu-id="270db-222">AKS kan även skalas med Virtual Kubelet som beskrivs nedan.</span><span class="sxs-lookup"><span data-stu-id="270db-222">AKS can also scale with the Virtual Kubelet described below.</span></span>

* <span data-ttu-id="270db-223">**Azure Container Instances (ACI)**</span><span class="sxs-lookup"><span data-stu-id="270db-223">**Azure Container Instances (ACI)**</span></span>
  
  <span data-ttu-id="270db-224">Azure Container Instances är en serverfri metod som gör att du kan skapa och köra containrar på begäran.</span><span class="sxs-lookup"><span data-stu-id="270db-224">Azure Container Instances is a serverless approach that lets you create and execute containers on-demand.</span></span> <span data-ttu-id="270db-225">Du debiteras endast för körningstid per sekund.</span><span class="sxs-lookup"><span data-stu-id="270db-225">You're charged only for the execution time per second.</span></span>

  <span data-ttu-id="270db-226">Du kan använda Virtual Kubelet för att ansluta Azure Container Instances till Kubernetes-miljön, inklusive AKS.</span><span class="sxs-lookup"><span data-stu-id="270db-226">You can use Virtual Kubelet to connect Azure Container Instances into your Kubernetes environment, including AKS.</span></span> <span data-ttu-id="270db-227">När Kubernetes-klustret kräver ytterligare containerinstanser kan du med Virtual Kubelet uppfylla dessa krav från ACI.</span><span class="sxs-lookup"><span data-stu-id="270db-227">With Virtual Kubelet, when your Kubernetes cluster demands additional container instances, those demands can be met from ACI.</span></span> <span data-ttu-id="270db-228">Eftersom ACI är serverfri finns det inget behov av att ha reserverad kapacitet.</span><span class="sxs-lookup"><span data-stu-id="270db-228">Since ACI is serverless, there is no need to have reserved capacity.</span></span> <span data-ttu-id="270db-229">Du kan därför dra nytta av kontrollen och flexibiliteten i Kubernetes-skalning med fakturering per sekund utan server.</span><span class="sxs-lookup"><span data-stu-id="270db-229">You can therefore take advantage of the control and flexibility of Kubernetes scaling with the per-second-billing of serverless.</span></span> <span data-ttu-id="270db-230">När detta skrivs betecknas Virtual Kubelet som experimentell programvara och ska inte användas i produktionsscenarier.</span><span class="sxs-lookup"><span data-stu-id="270db-230">At time of writing, the Virtual Kubelet is described as experimental software and should not be used in production scenarios.</span></span>

## <a name="scaling-at-lamna-healthcare"></a><span data-ttu-id="270db-231">Skalning på Lamna Healthcare</span><span class="sxs-lookup"><span data-stu-id="270db-231">Scaling at Lamna Healthcare</span></span>

<span data-ttu-id="270db-232">Lamna Healthcare har ett system för hantering och tidsbokning av patienter.</span><span class="sxs-lookup"><span data-stu-id="270db-232">Lamna Healthcare operates a patient management and booking system.</span></span> <span data-ttu-id="270db-233">Hanteringssystemet sköter tidsbokningar och patientjournaler för dussintals sjukhus och medicinska kliniker.</span><span class="sxs-lookup"><span data-stu-id="270db-233">The management system handles appointment bookings and patient records across dozens of hospitals and medical facilities.</span></span> <span data-ttu-id="270db-234">Den lokala sjukvårdstjänsten körs med full kapacitet och ingen tillväxt förväntas för närvarande.</span><span class="sxs-lookup"><span data-stu-id="270db-234">The local health service is running at full capacity and no growth is expected at the moment.</span></span> <span data-ttu-id="270db-235">Systemet körs på en PHP-webbplats i Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="270db-235">The system is running on a PHP Website hosted in Azure App Service.</span></span>

<span data-ttu-id="270db-236">Belastningsmönstret för programmet är förutsägbart, eftersom det främst är igång måndag till fredag mellan 9 och 17.</span><span class="sxs-lookup"><span data-stu-id="270db-236">The load pattern of the application is predictable, as they primarily operate Monday to Friday between the hours of 9 to 5.</span></span>  <span data-ttu-id="270db-237">Från tisdag till fredag hanteras i genomsnitt 1 200 transaktioner per timme i hela systemet.</span><span class="sxs-lookup"><span data-stu-id="270db-237">From Tuesday through to Friday, the system averages at 1,200 transactions per hour across the entire system.</span></span> <span data-ttu-id="270db-238">Under helgerna hanteras 500 transaktioner per timme.</span><span class="sxs-lookup"><span data-stu-id="270db-238">During the weekend, it handles 500 transactions per hour.</span></span> <span data-ttu-id="270db-239">Efter helgens lugn ökar trafiken på måndagar med ett genomsnitt på 2 000 transaktioner per timme.</span><span class="sxs-lookup"><span data-stu-id="270db-239">After the quiet of the weekend, Mondays are busy with an average of 2,000 transactions per hour.</span></span>

<span data-ttu-id="270db-240">Programmet finns på en S1-App Service-plan, men driftteamet har märkt av en hög nivå av CPU-användning (mer än 95 %) på alla instanser.</span><span class="sxs-lookup"><span data-stu-id="270db-240">The application is hosted on an S1 App Service Plan, but the operations team have noticed a high level of CPU utilization (over 95%) across all instances.</span></span> <span data-ttu-id="270db-241">Den höga användningen påverkar bearbetnings- och inläsningstiderna i programmet.</span><span class="sxs-lookup"><span data-stu-id="270db-241">The high usage is having an impact on the processing and loading times of the application.</span></span> <span data-ttu-id="270db-242">I en molnmiljö är det inte nödvändigtvis något dåligt att resurser används i hög grad.</span><span class="sxs-lookup"><span data-stu-id="270db-242">In a cloud environment, having highly utilized resources is not necessarily a bad thing.</span></span> <span data-ttu-id="270db-243">Det innebär att de får valuta för sina pengar, eftersom resurserna som har distribuerats utnyttjas väl.</span><span class="sxs-lookup"><span data-stu-id="270db-243">It means that they are getting value for their money, as the resources deployed are being well used.</span></span> 

<span data-ttu-id="270db-244">Teamet bestämmer sig för att _skala upp_ App Service-plannivån för de distribuerade instanserna från S1 (1 virtuell processor och 1,75 GB RAM-minne) till S2 (2 virtuella processorer och 3 GB RAM-minne).</span><span class="sxs-lookup"><span data-stu-id="270db-244">The team decide to _scale up_ the App Service Plan level for the deployed instances from S1 (1 vCPU and 1.75 GB of RAM) to S2 (2 vCPUs and 3 GB of RAM).</span></span> <span data-ttu-id="270db-245">Detta åstadkoms enkelt med hjälp av Azure-portalen, men de kan även uppnå samma sak med hjälp av ett enda kommando i Azure CLI, Azure PowerShell eller med hjälp av Resource Manager-mallar.</span><span class="sxs-lookup"><span data-stu-id="270db-245">They easily achieve this using the Azure portal, but could have achieved the same thing using a single command in the Azure CLI, Azure PowerShell, or using Resource Manager templates.</span></span>

<span data-ttu-id="270db-246">Teamet beslutar att de vill automatisera antalet distribuerade instanser baserat på ett schema, eftersom deras belastningsprofil är förutsägbar.</span><span class="sxs-lookup"><span data-stu-id="270db-246">The team decide that they want to automate the number of instances deployed based upon a schedule, as their load profile is predictable.</span></span> <span data-ttu-id="270db-247">De konfigurerar schemat för autoskalning av App Service-planen.</span><span class="sxs-lookup"><span data-stu-id="270db-247">They configure the app service plan's autoscale schedule.</span></span> <span data-ttu-id="270db-248">Anta att två instanser är tillräckligt för att hantera 500 transaktioner per timme.</span><span class="sxs-lookup"><span data-stu-id="270db-248">Let's assume two instances sufficiently handle 500 transactions per hour.</span></span> <span data-ttu-id="270db-249">Teamet kan sedan skala till sex instanser för tisdag till fredag och åtta instanser för måndagen för att uppfylla kraven (baserat på övervakning och insikter av belastningstester).</span><span class="sxs-lookup"><span data-stu-id="270db-249">The team could then scale to six instances for Tuesday - Friday and eight instances for a Monday to meet the requirements (based upon insight and monitoring from load tests).</span></span>

<span data-ttu-id="270db-250">Automatisk skalning ger även den extra fördelen att ha beredskap inför oförutsedda scenarier.</span><span class="sxs-lookup"><span data-stu-id="270db-250">Autoscale also gives them an added benefit, preparing for those unforeseen scenarios.</span></span> <span data-ttu-id="270db-251">Webbplatsen kan plötsligt få högre belastning under en helg (fler avtalade tider under vintersäsongen på grund av förkylningar och influensa).</span><span class="sxs-lookup"><span data-stu-id="270db-251">The site may suddenly take higher than expected load on the weekend (more appointments in the winter season because of colds and flu).</span></span> <span data-ttu-id="270db-252">Teamet kan ställa in automatisk skalning för att öka med en instans när CPU-användningen ligger över 90 % och minska med en instans när användningen går under 15 %.</span><span class="sxs-lookup"><span data-stu-id="270db-252">The team can set up autoscale to increase by one instance when CPU percentage is above 90% and reduce by one instance when usage is below 15%.</span></span>

<span data-ttu-id="270db-253">Teamet har använt mönstret för bandbreddsbegränsning för den patientboknings-API som exponerats bakom en Azure API Management-instans.</span><span class="sxs-lookup"><span data-stu-id="270db-253">The team have used the throttling pattern inside of the patient booking API they have exposed behind an Azure API Management instance.</span></span> <span data-ttu-id="270db-254">Detta förhindrar att systemet får sämre prestanda genom att bara tillåta en viss mängd dataflöde genom systemet.</span><span class="sxs-lookup"><span data-stu-id="270db-254">This helps prevent the system from performing poorly by only allowing a certain volume of throughput through the system.</span></span>

## <a name="summary"></a><span data-ttu-id="270db-255">Sammanfattning</span><span class="sxs-lookup"><span data-stu-id="270db-255">Summary</span></span>

<span data-ttu-id="270db-256">Vi har pratat om att skala upp och ned och skala in och ut och hur du kan utnyttja de här alternativen i din arkitektur.</span><span class="sxs-lookup"><span data-stu-id="270db-256">We've talked about scaling up and down and scaling in and out, and how you can leverage these options in your architecture.</span></span> <span data-ttu-id="270db-257">Vi har även tittat på hur serverfria tekniker och containrar kan utveckla dina skalningsmöjligheter.</span><span class="sxs-lookup"><span data-stu-id="270db-257">We've also looked at how serverless technologies and containers can help evolve your scaling capabilities.</span></span> <span data-ttu-id="270db-258">Nu ska vi ta en titt på hur nätverksprestanda kan påverka ditt program, och olika sätt att optimera nätverket.</span><span class="sxs-lookup"><span data-stu-id="270db-258">Next, we'll take a look at how network performance can impact your application, and different ways we can optimize the network.</span></span>