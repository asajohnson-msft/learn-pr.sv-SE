<span data-ttu-id="2d2bd-101">Direkt kommunikation mellan komponenterna i ett distribuerat program kan vara problematisk eftersom den kan avbrytas när nätverksbandbredden är låg eller när efterfrågan är hög.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-101">Direct communication between the components of a distributed application can be problematic because it might be disrupted when network bandwidth is low or when demand is high.</span></span>

<span data-ttu-id="2d2bd-102">I exemplet med fotodelning är planen att använda en kö för att eliminera direktlänken mellan dina kundriktade appar och din webbtjänst på mellannivå.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-102">In the photo-sharing example, the plan is to use a queue to eliminate the direct link between your customer-facing apps and your middle-tier web service.</span></span>

## <a name="what-is-azure-queue-storage"></a><span data-ttu-id="2d2bd-103">Vad är Azure Queue Storage?</span><span class="sxs-lookup"><span data-stu-id="2d2bd-103">What is Azure Queue storage?</span></span>

<span data-ttu-id="2d2bd-104">Azure Queue Storage är en Azure-tjänst som implementerar molnbaserade köer.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-104">Azure Queue storage is an Azure service that implements cloud-based queues.</span></span> <span data-ttu-id="2d2bd-105">Varje kö har en lista med meddelanden.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-105">Each queue maintains a list of messages.</span></span> <span data-ttu-id="2d2bd-106">Programkomponenter kommer åt en kö med hjälp av ett REST-API eller ett Azure-tillhandahållet klientbibliotek.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-106">Application components access a queue using a REST API or an Azure-supplied client library.</span></span> <span data-ttu-id="2d2bd-107">Du kommer normalt har en eller flera _avsändarkomponenter_ och en eller flera _mottagarkomponenter_.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-107">Typically, you will have one or more _sender_ components and one or more _receiver_ components.</span></span> <span data-ttu-id="2d2bd-108">Avsändarkomponenterna lägger till meddelande i kön.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-108">Sender components add message to the queue.</span></span> <span data-ttu-id="2d2bd-109">Mottagarkomponenter hämtar meddelanden som ligger först i kön för bearbetning.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-109">Receiver components retrieve messages from the front of the queue for processing.</span></span>

![Lagringsköer](../media-draft/2-queue-overview.png)

<span data-ttu-id="2d2bd-111">Prissättning baseras på köstorleken och antalet åtgärder.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-111">Pricing is based on queue size and number of operations.</span></span> <span data-ttu-id="2d2bd-112">Större meddelandeköer kostar mer än mindre köer.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-112">Larger message queues cost more than smaller queues.</span></span> <span data-ttu-id="2d2bd-113">Debitering sker även för varje åtgärd, till exempel att lägga till ett meddelande och ta bort ett meddelande.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-113">Charges are also incurred for each operation, such as adding a message and deleting a message.</span></span> <span data-ttu-id="2d2bd-114">Information om priser finns i [Prissättning för Azure Queues Storage](https://azure.microsoft.com/pricing/details/storage/queues/).</span><span class="sxs-lookup"><span data-stu-id="2d2bd-114">For pricing details, see [Azure Queues Storage pricing](https://azure.microsoft.com/pricing/details/storage/queues/).</span></span>

## <a name="why-use-queues"></a><span data-ttu-id="2d2bd-115">Varför bör jag använda köer?</span><span class="sxs-lookup"><span data-stu-id="2d2bd-115">Why use queues?</span></span>

<span data-ttu-id="2d2bd-116">Köer ökar robustheten genom att tillfälligt lagra väntande meddelanden.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-116">A queue increases resiliency by temporarily storing waiting messages.</span></span> <span data-ttu-id="2d2bd-117">När efterfrågan är låg eller normal förblir storleken på kön liten eftersom målkomponenten tar bort meddelanden från kön snabbare än de läggs till.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-117">At times of low or normal demand, the size of the queue remains small because the destination component removes messages from the queue faster than they are added.</span></span> <span data-ttu-id="2d2bd-118">När efterfrågan är hög kan köstorleken öka, men meddelandena går inte förlorade.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-118">At times of high demand, the queue may increase in size but messages are not lost.</span></span> <span data-ttu-id="2d2bd-119">Målkomponenten kan fånga och tömma kön när efterfrågan blir normal igen.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-119">The destination component can catch up and empty the queue as demand returns to normal.</span></span>

<span data-ttu-id="2d2bd-120">En enskild kö kan ha en storlek på upp till 500 TB, så den kan potentiellt kan lagra miljontals meddelanden.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-120">A single queue can be up to 500 TB in size so it can potentially store millions of messages.</span></span> <span data-ttu-id="2d2bd-121">Måldataflödet för en enskild kö är 2 000 meddelanden per sekund, så den kan hantera stora mängder.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-121">The target throughput for a single queue is 2000 messages per second so it can handle high-volume scenarios.</span></span>

<span data-ttu-id="2d2bd-122">Köer gör att ditt program kan skalas automatiskt och omedelbart när efterfrågan ändras.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-122">Queues let your application scale automatically and immediately when demand changes.</span></span> <span data-ttu-id="2d2bd-123">Det gör att de är användbara för kritiska affärsdata som skulle vara skadliga att förlora.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-123">This makes them useful for critical business data that would be damaging to lose.</span></span> <span data-ttu-id="2d2bd-124">Azure erbjuder många andra tjänster som skalar automatiskt.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-124">Azure offers many other services that scale automatically.</span></span> <span data-ttu-id="2d2bd-125">Till exempel är funktionen **Autoskalning** tillgänglig på Azure VM-skalningsuppsättningar, molntjänster, App Service-planer och App Service-miljöer.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-125">For example, the **Autoscale** feature is available on Azure VM scale sets, cloud services, App Service plans, and App Service environments.</span></span> <span data-ttu-id="2d2bd-126">På så sätt kan du definiera regler som Azure använder för att identifiera perioder med hög efterfrågan och automatiskt lägga till kapacitet utan hjälp från en administratör.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-126">This lets you define rules that Azure uses to identify periods of high demand and automatically add capacity without involving an administrator.</span></span> <span data-ttu-id="2d2bd-127">Automatisk skalning svarar på efterfrågan snabbt men inte omedelbart.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-127">Autoscaling responds to demand quickly, but not instantaneously.</span></span> <span data-ttu-id="2d2bd-128">Däremot hanterar Azure Queue Storage hög efterfrågan omedelbart genom att lagra meddelanden tills bearbetningsresurser blir tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-128">By contrast, Azure Queue storage instantaneously handles high demand by storing messages until processing resources are available.</span></span>

## <a name="what-is-a-message"></a><span data-ttu-id="2d2bd-129">Vad är ett meddelande?</span><span class="sxs-lookup"><span data-stu-id="2d2bd-129">What is a message?</span></span>

<span data-ttu-id="2d2bd-130">Ett meddelande i en kö är en bytematris på upp till 64 KB.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-130">A message in a queue is a byte array of up to 64 KB.</span></span> <span data-ttu-id="2d2bd-131">Meddelandeinnehåll tolkas inte alls av Azure-komponenter.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-131">Message contents are not interpreted at all by any Azure component.</span></span>

<span data-ttu-id="2d2bd-132">Om du vill skapa ett strukturerat meddelande kan du formatera meddelandeinnehållet med hjälp av XML eller JSON.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-132">If you want to create a structured message, you could format the message content using XML or JSON.</span></span> <span data-ttu-id="2d2bd-133">Din kod ansvarar för att generera och tolka ditt anpassade format.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-133">Your code is responsible for generating and interpreting your custom format.</span></span> <span data-ttu-id="2d2bd-134">Du kan till exempel skapa ett anpassat JSON-meddelande som ser ut som följande:</span><span class="sxs-lookup"><span data-stu-id="2d2bd-134">For example, you could make a custom JSON message that looks like the following:</span></span>

    ```JavaScript
    {
        "Message": {
            "To": "admin@contoso.com",
            "From": "user1@contoso.com",
            "Subject": "Support request",
            "Body": "My computer will not switch on."
        }
    }
    ```

## <a name="storage-account-settings-for-queues"></a><span data-ttu-id="2d2bd-135">Lagringskontoinställningar för köer</span><span class="sxs-lookup"><span data-stu-id="2d2bd-135">Storage Account Settings for Queues</span></span>

<span data-ttu-id="2d2bd-136">En kö måste vara medlem i ett lagringskonto.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-136">A queue must be a member of a Storage Account.</span></span> <span data-ttu-id="2d2bd-137">När du skapar ett lagringskonto som kommer att innehålla köer bör du överväga följande inställningar:</span><span class="sxs-lookup"><span data-stu-id="2d2bd-137">When you create a Storage Account that will contain queues, you should consider the following settings:</span></span>

- <span data-ttu-id="2d2bd-138">Köer är endast tillgängliga som en del av Azure-lagringskonton för generell användning.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-138">Queues are only available as part of Azure general purpose Storage Accounts.</span></span> <span data-ttu-id="2d2bd-139">Du kan inte lägga till dem till Blob Storage-konton.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-139">You cannot add them to Blob storage accounts.</span></span>
- <span data-ttu-id="2d2bd-140">Välj en plats som ligger nära antingen källkomponenterna eller målkomponenterna eller helst båda.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-140">Choose a location that is close to either the source components or destination components or, preferably, both.</span></span>
- <span data-ttu-id="2d2bd-141">Data i ett Azure Storage-konto replikeras alltid till flera servrar för att skydda mot diskfel och andra maskinvaruproblem.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-141">Data in an Azure Storage account is always replicated to multiple servers to guard against disk failures and other hardware problems.</span></span> <span data-ttu-id="2d2bd-142">Du kan välja replikeringsstrategi: lokalt redundant lagring (LRS) har en låg kostnad men är sårbar för katastrofer som påverkar ett helt datacenter, medan geo-redundant lagring (GRS) replikerar data till andra Azure-datacenter.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-142">You have a choice of replication strategies: Locally Redundant Storage (LRS) is low-cost but vulnerable to disasters that affect an entire data center while Geo-Redundant Storage (GRS) replicates data to other Azure data centers.</span></span>
- <span data-ttu-id="2d2bd-143">Prestandanivån avgör hur ditt meddelande lagras: Standard använder magnetiska hårddiskar medan Premium använder SSD-diskar.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-143">The performance tier determines how your message are stored: Standard uses magnetic drives while Premium uses solid-state drives.</span></span> <span data-ttu-id="2d2bd-144">Välj Standard om du förväntar dig att toppar i efterfrågan kommer att vara kortvariga.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-144">Choose Standard if you expect peaks in demand to be short.</span></span> <span data-ttu-id="2d2bd-145">Överväg Premium om kölängden ibland blir lång och om du behöver minimera åtkomsttiden för meddelanden.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-145">Consider Premium if queue length sometimes becomes long and you need to minimize the time to access messages.</span></span>
- <span data-ttu-id="2d2bd-146">Kräv säker överföring om känslig information kan skickas via kön.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-146">Require secure transfer if sensitive information may pass through the queue.</span></span> <span data-ttu-id="2d2bd-147">Den här inställningen ser till att alla anslutningar till kön krypteras med hjälp av Secure Sockets Layer (SSL).</span><span class="sxs-lookup"><span data-stu-id="2d2bd-147">This setting ensures that all connections to the queue are encrypted using Secure Sockets Layer (SSL).</span></span>

> [!NOTE]
> <span data-ttu-id="2d2bd-148">Inställningen för **Åtkomstnivå** gäller enbart för Blob Storage och påverkar inte köer.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-148">The **Access tier** setting applies only to Blob storage and does not affect queues.</span></span>

## <a name="summary"></a><span data-ttu-id="2d2bd-149">Sammanfattning</span><span class="sxs-lookup"><span data-stu-id="2d2bd-149">Summary</span></span>

<span data-ttu-id="2d2bd-150">Många distribuerade program använder direkt kommunikation för att utbyta information.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-150">Many distributed applications use direct communication to exchange information.</span></span> <span data-ttu-id="2d2bd-151">En webbsida kan till exempel anropa en metod i en webbtjänst.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-151">For example, a webpage might call a method in a web service.</span></span> <span data-ttu-id="2d2bd-152">Den här strukturen är tillförlitlig så länge kommunikationen sker snabbt mellan dessa komponenter och målkomponenten kan svara i god tid.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-152">This arrangement is reliable as long as communication is quick between those components and the destination component can respond in a timely manner.</span></span> <span data-ttu-id="2d2bd-153">Om du inte garantera snabb kommunikation eller har problem med hög efterfrågan är en kö ett sätt att lägga till extra robusthet i programmet.</span><span class="sxs-lookup"><span data-stu-id="2d2bd-153">If you cannot guarantee fast communications or you have problems with high demand, then a queue is one way to add extra resiliency to your application.</span></span>