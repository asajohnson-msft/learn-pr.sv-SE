<span data-ttu-id="d389e-101">När vi har en uppfattning om hur vi ska lagra data i lagringskonton, behållare och blobar kan vi tänka på de Azure-resurser som vi måste skapa för att appen ska fungera.</span><span class="sxs-lookup"><span data-stu-id="d389e-101">Once we have an idea of how we're going to store data across storage accounts, containers and blobs, we can think about the Azure resources we need to create to support the app.</span></span>

### <a name="storage-accounts"></a><span data-ttu-id="d389e-102">Lagringskonton</span><span class="sxs-lookup"><span data-stu-id="d389e-102">Storage accounts</span></span>

<span data-ttu-id="d389e-103">Skapande av lagringskonton är en administrativ-/hanteringsaktivitet som utförs innan du distribuerar och kör din app.</span><span class="sxs-lookup"><span data-stu-id="d389e-103">Storage account creation is an administrative/management activity that takes place prior to deploying and running your app.</span></span> <span data-ttu-id="d389e-104">Konton skapas vanligtvis av ett konfigurationsskript för distribution eller miljöer, en Azure Resource Manager-mall, eller manuellt av en administratör.</span><span class="sxs-lookup"><span data-stu-id="d389e-104">Accounts are usually created by a deployment or environment setup script, an Azure Resource Manager template, or manually by an administrator.</span></span> <span data-ttu-id="d389e-105">Andra program än administrationsverktyg bör generellt sätt inte ha behörighet att skapa lagringskonton.</span><span class="sxs-lookup"><span data-stu-id="d389e-105">Applications other than administrative tools generally should not have permissions to create storage accounts.</span></span>

### <a name="containers"></a><span data-ttu-id="d389e-106">Containrar</span><span class="sxs-lookup"><span data-stu-id="d389e-106">Containers</span></span>

<span data-ttu-id="d389e-107">Till skillnad från skapande av lagringskonton är skapandet av behållare en enkel aktivitet som kan utföras inifrån en app.</span><span class="sxs-lookup"><span data-stu-id="d389e-107">Unlike storage account creation, container creation is a lightweight activity that makes sense to perform from within an app.</span></span> <span data-ttu-id="d389e-108">Det är inte ovanligt att appar skapar och tar bort behållare som en del av sättet de arbetar.</span><span class="sxs-lookup"><span data-stu-id="d389e-108">It's not uncommon for apps to create and delete containers as part of their work.</span></span>

<span data-ttu-id="d389e-109">För appar som förlitar sig på en känd uppsättning av behållare med hårdkodade eller förkonfigurerade namn är den vanliga metoden att låta appen skapa behållarna som behövs vid start eller vid första användning om de inte redan finns.</span><span class="sxs-lookup"><span data-stu-id="d389e-109">For apps that rely on a known set of containers with hard-coded or preconfigured names, typical practice is to let the app create the containers it needs on startup or first usage if they don't already exist.</span></span> <span data-ttu-id="d389e-110">Att låta appen skapa behållare i stället för att göra det som en del av distributionen av appen eliminerar behovet för både appen och distributionsprocessen att känna till namnen på behållarna som appen använder.</span><span class="sxs-lookup"><span data-stu-id="d389e-110">Letting your app create containers instead of doing it as part of your app's deployment eliminates the need for both your application and your deployment process to know the names of the containers the app uses.</span></span>

## <a name="exercise"></a><span data-ttu-id="d389e-111">Övning</span><span class="sxs-lookup"><span data-stu-id="d389e-111">Exercise</span></span>

<span data-ttu-id="d389e-112">Vi kommer att färdigställa en oavslutat ASP.NET Core-app genom att lägga till kod för att använda Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="d389e-112">We're going to complete an unfinished ASP.NET Core app by adding code to use Azure Blob storage.</span></span> <span data-ttu-id="d389e-113">Den här övningen handlar mer om att utforska API för Blob-lagring än om att utforma en organisations- och namngivningsschema, men här är en snabb överblick över appen och hur den lagrar data:</span><span class="sxs-lookup"><span data-stu-id="d389e-113">This exercise is more about exploring the Blob storage API than it is about designing an organization and naming scheme, but here's a quick overview of the app and how it stores data:</span></span>

<span data-ttu-id="d389e-114">**Att göra: Skärmbild av appen eftersom de inte kommer att se hur den körs hela vägen**</span><span class="sxs-lookup"><span data-stu-id="d389e-114">**TODO screenshot of app, since they're not going to see it run until the end**</span></span>

<span data-ttu-id="d389e-115">Vår app fungerar som en delad mapp som tar emot filuppladdningar och gör dem tillgängliga för nedladdning.</span><span class="sxs-lookup"><span data-stu-id="d389e-115">Our app works like a shared folder that accepts file uploads and makes them available for download.</span></span> <span data-ttu-id="d389e-116">Den använder inte en databas för att organisera blobar &mdash; i stället sanerar den namnen på de uppladdade filerna och använder dem som blobnamn direkt.</span><span class="sxs-lookup"><span data-stu-id="d389e-116">It doesn't use a database for organizing blobs &mdash; instead, it sanitizes the names of uploaded files and uses them as blob names directly.</span></span> <span data-ttu-id="d389e-117">Alla uppladdade filer lagras i en enskild behållare.</span><span class="sxs-lookup"><span data-stu-id="d389e-117">All uploaded files are stored in a single container.</span></span>

<span data-ttu-id="d389e-118">Koden vi börjar med kompileras och körs, men delarna som är ansvariga för att lagra och läsa in data är tomma.</span><span class="sxs-lookup"><span data-stu-id="d389e-118">The code we'll start with compiles and runs, but the parts responsible for storing and loading data are empty.</span></span> <span data-ttu-id="d389e-119">När vi har slutfört koden kan vi distribuera appen till Azure App Service och testa den.</span><span class="sxs-lookup"><span data-stu-id="d389e-119">After we complete the code, we'll deploy the app to Azure App Service and test it.</span></span>

<span data-ttu-id="d389e-120">Vi kan ställa in lagringsinfrastrukturen för vår app.</span><span class="sxs-lookup"><span data-stu-id="d389e-120">Let's set up the storage infrastructure for our app.</span></span>

### <a name="resource-group-and-storage-account"></a><span data-ttu-id="d389e-121">Resursgrupp och lagringskonto</span><span class="sxs-lookup"><span data-stu-id="d389e-121">Resource group and storage account</span></span>
<span data-ttu-id="d389e-122">Först skapar vi en resursgrupp som ska innehålla alla resurser i den här övningen.</span><span class="sxs-lookup"><span data-stu-id="d389e-122">First, we'll create a resource group to contain all of the resources in this exercise.</span></span> <span data-ttu-id="d389e-123">På slutet kommer vi att ta bort den för att rensa bort allt vi skapat.</span><span class="sxs-lookup"><span data-stu-id="d389e-123">We'll delete it at the end to clean up everything we create.</span></span> <span data-ttu-id="d389e-124">Vi ska även skapa lagringskontot vår app ska använda för att lagra blobar.</span><span class="sxs-lookup"><span data-stu-id="d389e-124">We'll also create the storage account our app will use to store blobs.</span></span>

<span data-ttu-id="d389e-125">Använd Azure Cloud Shell-terminalen för att skapa resursgruppen och lagringskontot genom att köra följande Azure CLI-kommandon.</span><span class="sxs-lookup"><span data-stu-id="d389e-125">Use the Azure Cloud Shell terminal to create the resource group and storage account by running the following Azure CLI commands.</span></span> <span data-ttu-id="d389e-126">Du måste ange ett unikt namn för lagringskontot &mdash;. Gör en anteckning om det till senare.</span><span class="sxs-lookup"><span data-stu-id="d389e-126">You'll need to provide a unique name for the storage account &mdash; make a note of it for later.</span></span> <span data-ttu-id="d389e-127">Valet av `eastus` för platsen är godtycklig.</span><span class="sxs-lookup"><span data-stu-id="d389e-127">The choice of `eastus` for the location is arbitrary.</span></span>

```console
az group create --name blob-exercise-group --location eastus
az storage account create --name <your-unique-storage-account-name> --resource-group blob-exercise-group --location eastus --kind StorageV2
```

<span data-ttu-id="d389e-128">**Att göra: det nedanför bör placeras i Azure Storage-modulen**</span><span class="sxs-lookup"><span data-stu-id="d389e-128">**TODO below should go in Azure Storage module**</span></span>

> [!NOTE]
> <span data-ttu-id="d389e-129">Varför `--kind StorageV2`?</span><span class="sxs-lookup"><span data-stu-id="d389e-129">Why `--kind StorageV2`?</span></span> <span data-ttu-id="d389e-130">Det finns ett antal olika typer av lagringskonton.</span><span class="sxs-lookup"><span data-stu-id="d389e-130">There are a few different kinds of storage accounts.</span></span> <span data-ttu-id="d389e-131">I de flesta fall bör du använda General-purpose v2-konton (kännetecknas av `StorageV2`).</span><span class="sxs-lookup"><span data-stu-id="d389e-131">For most scenarios, you should use general-purpose v2 storage accounts (signified with `StorageV2`).</span></span> <span data-ttu-id="d389e-132">Den enda orsaken v2-lagringskontona måste anges här är att de fortfarande är relativt nya och att de ännu inte är standard i Azure-portalen eller Azure CLI.</span><span class="sxs-lookup"><span data-stu-id="d389e-132">The only reason v2 storage accounts need to be specified here is that they are still fairly new and have not yet been made the default in the Azure Portal or the Azure CLI.</span></span>

### <a name="container"></a><span data-ttu-id="d389e-133">Container</span><span class="sxs-lookup"><span data-stu-id="d389e-133">Container</span></span>
<span data-ttu-id="d389e-134">Appen som vi kommer att arbeta med i den här modulen använder en enskild behållare.</span><span class="sxs-lookup"><span data-stu-id="d389e-134">The app we'll be working with in this module uses a single container.</span></span> <span data-ttu-id="d389e-135">Vi ska följa regelverket och låta appen skapa behållaren vid start.</span><span class="sxs-lookup"><span data-stu-id="d389e-135">We're going to follow the best practice of letting the app create the container at startup.</span></span> <span data-ttu-id="d389e-136">Men skapandet av en behållare kan göras från Azure CLI: kör `az storage container create -h` i Cloud Shell-terminalen om du vill se dokumentationen.</span><span class="sxs-lookup"><span data-stu-id="d389e-136">However, container creation can be done from the Azure CLI: run `az storage container create -h` in the Cloud Shell terminal if you'd like to see the documentation.</span></span>